{% extends "_layouts/cp" %}

{% set title = title ?? "Translations" %}
{% set selectedSubnavItem = "translations" %}

{% block content %}
  <div class="flex" style="gap: 24px;">
    <aside id="pt-sidebar" style="width: 200px; flex: 0 0 200px;">
      <div style="position: sticky; top: 24px;">
        <div class="flex justify-between align-center" style="margin-bottom: 8px;">
          <div class="meta">Navigation</div>
          <button class="btn small" id="pt-sidebar-toggle" type="button">Collapse</button>
        </div>
        <ul class="nav" id="pt-sidebar-nav">
          <li><a class="{{ activeSection == 'entries' ? 'sel' : '' }}" href="{{ url('pragmatic-translations/entries', { group: group, q: search, perPage: perPage, page: page|default(1) }) }}">Entradas</a></li>
          <li><a class="{{ activeSection == 'import-export' ? 'sel' : '' }}" href="{{ url('pragmatic-translations/import-export', { group: group, q: search, perPage: perPage }) }}">Importar/exportar</a></li>
          <li><a class="{{ activeSection == 'groups' ? 'sel' : '' }}" href="{{ url('pragmatic-translations/groups', { group: group, q: search, perPage: perPage }) }}">Grupos</a></li>
          <li><a class="{{ activeSection == 'options' ? 'sel' : '' }}" href="{{ url('pragmatic-translations/options', { group: group, q: search, perPage: perPage }) }}">Opciones</a></li>
        </ul>
      </div>
    </aside>

    <div style="flex: 1;">
      {% block main %}{% endblock %}
    </div>
  </div>

  {% js %}
    (function() {
      const sidebar = document.getElementById('pt-sidebar');
      const nav = document.getElementById('pt-sidebar-nav');
      const toggle = document.getElementById('pt-sidebar-toggle');
      if (sidebar && nav && toggle) {
        const applyState = function(collapsed) {
          if (collapsed) {
            sidebar.style.width = '52px';
            sidebar.style.flex = '0 0 52px';
            nav.style.display = 'none';
            toggle.textContent = 'Expand';
            sidebar.setAttribute('data-collapsed', '1');
          } else {
            sidebar.style.width = '200px';
            sidebar.style.flex = '0 0 200px';
            nav.style.display = '';
            toggle.textContent = 'Collapse';
            sidebar.setAttribute('data-collapsed', '0');
          }
        };

        const saved = localStorage.getItem('ptSidebarCollapsed');
        applyState(saved === '1');

        toggle.addEventListener('click', function() {
          const isCollapsed = sidebar.getAttribute('data-collapsed') === '1';
          const next = !isCollapsed;
          applyState(next);
          localStorage.setItem('ptSidebarCollapsed', next ? '1' : '0');
        });
      }
    })();
  {% endjs %}
{% endblock %}
